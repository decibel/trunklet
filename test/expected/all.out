\set ECHO none
ok 1 - threw 22023: field_name must not be NULL
ok 2 - threw 22023: field_name must not be blank
ok 3 - threw 22023: field_name must not begin with whitespace
ok 4 - threw 22023: field_name must not begin with whitespace
ok 5 - threw 22023: field_name must not end with whitespace
ok 6 - threw 22023: field_name must not begin with whitespace
ok 7 - threw 22023: field_name must not begin with whitespace
ok 8 - threw 22023: field_name must not end with whitespace
ok 9 - threw 22023: field_name must not begin with whitespace
ok 10 - threw 22023: field_name must not begin with whitespace
ok 11 - threw 22023: field_name must not end with whitespace
ok 12 - Column _trunklet.language.language_name should be type character varying(100)
ok 13 - Verify CHECK constraint on _trunklet.language.language_name
ok 14 - c_language_id IS NOT NULL
ok 15 - (template_name, template_version) should be unique
ok 16 - Role public should be granted no privileges on table _trunklet.template
ok 17 - Role trunklet__dependency should be granted REFERENCES on table _trunklet.template
ok 18 - Verify CHECK constraint on _trunklet.template.template_name
ok 19 - language__get_id: returns correct id
ok 20 - language__get_id: throws language not found
ok 21 - trunklet.process(): invalid language
ok 22 - trunklet.process(): invalid template
ok 23 - trunklet.process(): invalid parameter
ok 24 - trunklet.process( ..., '%s', '{a}' )
ok 25 - trunklet.process( ..., '%s %s', '{a,b}' )
ok 26 - trunklet.process( ..., '%s %s', '{a,NULL}' )
ok 27 - trunklet.process( ..., '%s', '{NULL}' )
ok 28 - trunklet.process( ..., 'moo', NULL )
ok 29 - Role public should be granted USAGE on schema trunklet
ok 30 - Role public should be granted no privileges on schema _trunklet
ok 31 - Role trunklet__dependency should be granted USAGE on schema _trunklet
ok 32 - Role public should be granted USAGE on schema _trunklet_functions

not ok 33 - template__add: throw error when given bad template type # TODO Need to implement template type enforcement
# Failed (TODO) test 33: "template__add: throw error when given bad template type"
#       caught: no exception
#       wanted: 12345
ok 34 - Verify template__add results
ok 35 - threw with proper context 42P01: relation "bogus_table" does not exist
ok 36 - dependency__add: column does not exist
ok 37 - dependency__add: insufficient privilege
ok 38 - dependency__add: success
ok 39 - _trunklet_test.test_dependency(test_template_id) should reference _trunklet.template(template_id)
ok 40 - dependency__remove: success
ok 41 - FK does not exist
ok 42 - dependency__remove: constraint does not exist
ok 43 - dependency__remove: undefined table
ok 44 - dependency__remove: column does not exist
ok 45 - Role public should be granted no privileges on function _trunklet.template__get(character varying(100), text, int)
ok 46 - threw P0002: language "bogus template language that does not exist" not found
ok 47 - threw P0002: template with language "Our internal test language", template name "bogus" and version 1 not found
ok 48 - Test templates removed by name/version
ok 49 - Test templates removed by id
ok 50 - View trunklet.template_language should exist
ok 51 - Table trunklet.template_language should have the correct columns
ok 52 - Role public should be granted no privileges on table trunklet.template_language
ok 53 - template_language returns same results as _trunklet.language
ok 54 - threw 22023: language_name must not be NULL
ok 55 - Verify we can create test language
ok 56 - Verify type added to registered variant "trunklet_template"
ok 57 - Verify type added to registered variant "trunklet_parameter"
ok 58 - Verify type added to registered variant "trunklet_return"
ok 59 - Role public should be granted no privileges on function trunklet.template_language__add(character varying(100), regtype, regtype, text, text, text, text)
1..59
